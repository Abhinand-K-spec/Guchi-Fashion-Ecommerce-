<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Admin Dashboard</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />

  <style>
    /* ------------------------------- */
    /* GLOBAL DARK THEME */
    /* ------------------------------- */
    body.bg-dark {
      background-color: #1a1b26 !important;
      color: #f5f5f5 !important;
    }
    .bg-dark-secondary {
      background-color: #242531 !important;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    .text-muted { color: #a5a5b0 !important; }
    .btn-primary {
      background-color: #6c63ff !important;
      border-color: #6c63ff !important;
    }

    /* ------------------------------- */
    /* LAYOUT FIXES */
    /* ------------------------------- */
    .sidebar-menu {
      width: 250px;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
    }
   

    /* ------------------------------- */
    /* CARD CHART CONTAINERS */
    /* ------------------------------- */
    .chart-container-large {
      position: relative;
      width: 100%;
      height: 280px;
    }
    .kpi-sparkline {
      height: 35px !important;
      width: 100%;
    }
    canvas {
      max-width: 100%;
    }
  </style>
    <%- include("../partials/admin/header") %> 

</head>

<body class="bg-dark">
  <div class="main-content">
    <div class="container-fluid">

      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-white">Analytics</h2>
        <button class="btn btn-primary btn-sm">Export</button>
      </div>

      <!-- KPI ROW -->
      <div class="row mb-5">
        <div class="col-lg-3 col-md-6 mb-4">
          <div class="card bg-dark-secondary border-0 shadow-sm">
            <div class="card-body">
              <p class="text-white small mb-0">Saved Products</p>
              <h3 class="text-white">50,800</h3>
              <p class="text-success small mb-2">+28.4% vs last month</p>
              <canvas id="sparklineSaveProducts" class="kpi-sparkline"></canvas>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-4">
          <div class="card bg-dark-secondary border-0 shadow-sm">
            <div class="card-body">
              <p class="text-white small mb-0">Stock Products</p>
              <h3 class="text-white">23,600</h3>
              <p class="text-danger small mb-2">-12.6% vs last month</p>
              <canvas id="sparklineStockProducts" class="kpi-sparkline"></canvas>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-4">
          <div class="card bg-dark-secondary border-0 shadow-sm">
            <div class="card-body">
              <p class="text-white small mb-0">Sale Products</p>
              <h3 class="text-white">756</h3>
              <p class="text-success small mb-2">+3.1% vs last month</p>
              <canvas id="sparklineSaleProducts" class="kpi-sparkline"></canvas>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-4">
          <div class="card bg-dark-secondary border-0 shadow-sm">
            <div class="card-body">
              <p class="text-white small mb-0">Average Revenue</p>
              <h3 class="text-white">â‚¹2,300</h3>
              <p class="text-success small mb-2">+11.3% vs last month</p>
              <canvas id="sparklineAvgRevenue" class="kpi-sparkline"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- CHARTS -->
      <div class="row mb-5">
        <div class="col-lg-4 mb-4">
          <div class="card bg-dark-secondary border-0 shadow-sm">
            <div class="card-body text-center">
              <h5 class="text-white mb-3">Website Visitors</h5>
              <div class="chart-container-large mx-auto" style="height: 200px;">
                <canvas id="websiteVisitorsChart"></canvas>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-8 mb-4">
          <div class="card bg-dark-secondary border-0 shadow-sm">
            <div class="card-body">
              <h5 class="text-white mb-3">Revenue by Customer Type</h5>
              <div class="chart-container-large">
                <canvas id="revenueByCustomerChart"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- LINE CHART -->
      <div class="card bg-dark-secondary border-0 shadow-sm mb-5">
        <div class="card-body">
          <h5 class="text-white mb-3">Completed Tasks Over Time</h5>
          <div class="chart-container-large">
            <canvas id="completedTasksChart"></canvas>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>

  <script>
    // Sparkline Creator
    const createSparkline = (id, data, color) => {
      const ctx = document.getElementById(id);
      if (!ctx) return;
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.map((_, i) => i + 1),
          datasets: [{
            data,
            borderColor: color,
            borderWidth: 1.5,
            fill: false,
            tension: 0.4,
            pointRadius: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: { x: { display: false }, y: { display: false } }
        }
      });
    };

    // KPI Sparklines
    createSparkline('sparklineSaveProducts', [10, 20, 15, 25, 20, 30, 25], '#4CAF50');
    createSparkline('sparklineStockProducts', [30, 25, 35, 20, 28, 15, 22], '#DC3545');
    createSparkline('sparklineSaleProducts', [5, 10, 8, 12, 10, 15, 13], '#4CAF50');
    createSparkline('sparklineAvgRevenue', [1500, 2000, 1800, 2500, 2200, 2800, 2300], '#6c63ff');

    // Doughnut Chart
    new Chart(document.getElementById('websiteVisitorsChart'), {
      type: 'doughnut',
      data: {
        labels: ['Shirts', 'Pants', 'Shorts'],
        datasets: [{
          data: [30, 50, 20],
          backgroundColor: ['#6c63ff', '#4a42e0', '#2e26c4'],
          borderWidth: 0
        }]
      },
      options: {
        cutout: '70%',
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } }
      }
    });

    // Revenue by Customer Type
    new Chart(document.getElementById('revenueByCustomerChart'), {
      type: 'bar',
      data: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
        datasets: [
          { label: 'Current clients', data: [10000, 12000, 15000, 11000, 18000, 14000], backgroundColor: '#6c63ff' },
          { label: 'Subscribers', data: [5000, 6000, 7500, 5500, 9000, 7000], backgroundColor: '#938cff' },
          { label: 'New customers', data: [2000, 3000, 4000, 3500, 5000, 4500], backgroundColor: '#c0baff' }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: { stacked: true, grid: { color: 'rgba(255,255,255,0.1)' } },
          y: { stacked: true, beginAtZero: true, grid: { color: 'rgba(255,255,255,0.1)' } }
        },
        plugins: { legend: { labels: { color: '#fff' } } }
      }
    });

    // Completed Tasks (Line)
    new Chart(document.getElementById('completedTasksChart'), {
      type: 'line',
      data: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
        datasets: [{
          label: 'Tasks',
          data: [50, 80, 60, 100, 70, 120],
          borderColor: '#6c63ff',
          backgroundColor: 'rgba(108, 99, 255, 0.2)',
          fill: true,
          tension: 0.4
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          x: { grid: { color: 'rgba(255,255,255,0.1)' } },
          y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.1)' } }
        }
      }
    });
  </script>
</body>
</html>
